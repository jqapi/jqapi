---
import Signatures from "./EntrySignatures.astro";

const { entry } = Astro.props;
const name = entry.find("entry").attr("name");
const title = entry.find("entry > title").text();
const desc = entry.find("entry > desc").text();
const content = entry.find("longdesc").html();
---

<div id="entry">
  <ul id="entry-nav"></ul>

  <div id="entry-content">
    <section class="section">
      <h1 class="title is-2">{title}</h1>
      <h2 class="subtitle is-5">{desc}</h2>

      <Signatures entry={entry} />

      <div class="content">
        <Fragment set:html={content} />
      </div>
    </section>
  </div>
</div>

<script>
  import $ from "jquery";
  import enrichContent from "../lib/enrich-content.mjs";

  $(() => {
    enrichContent();
  });
</script>

<style>
  #entry {
    height: 100%;
  }

  #entry-nav {
    min-height: 36px;
    background: #edf3fe;
    border-bottom: 1px solid #d4e4fc;
  }

  #entry-content {
    height: calc(100% - 36px);
    overflow: scroll;
  }

  .section {
    padding-top: 24px;
  }

  table tr td:first-child {
    width: 200px;
  }
</style>

<style is:global>
  /* somehow purgecss removes these styles, even with safelist, so restore them here */
  #entry-content pre {
    border-radius: 3px;
    box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.2);
    border: 1px soild #222;
    display: none;
    background: hsl(220, 13%, 18%);
    color: hsl(220, 14%, 71%);
    text-shadow: 0 1px rgba(0, 0, 0, 0.3);
  }

  /* the following styles fix glitches caused by Bulma's .content */
  #entry-content pre .tag,
  #entry-content pre .number {
    background: none;
    font-size: 1em;
    padding: 0;
    margin: 0;
    height: 1em;
    min-width: auto;
    vertical-align: baseline;
  }

  #entry-content pre .attr-name {
    padding-left: 0.6em;
  }
</style>
